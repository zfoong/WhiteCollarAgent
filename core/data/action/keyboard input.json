{
  "_id": {
    "$oid": "688dd91112c6041305c2b1da"
  },
  "name": "keyboard input",
  "description": "Sends arbitrary keystrokes or key-combination shortcuts to the currently focused window (e.g., \"ctrl+c\", [\"alt+tab\", \"f5\"]).",
  "type": "atomic",
  "execution_mode": "sandboxed",
  "mode": "GUI",
  "input_schema": {
    "keys": {
      "type": [
        "string",
        "array"
      ],
      "example": [
        "ctrl+c",
        "alt+tab"
      ],
      "description": "A single key/combo string (\"enter\", \"ctrl+shift+t\") or a list of such strings executed in order (required)."
    }
  },
  "output_schema": {
    "status": {
      "type": "string",
      "example": "success",
      "description": "'success' if all inputs were sent, 'error' otherwise."
    },
    "message": {
      "type": "string",
      "example": "Invalid key string.",
      "description": "Optional error message on failure."
    }
  },
  "subActions": [],
  "default": false,
  "scope": [
    "global"
  ],
  "code": "import json, sys, subprocess, importlib\npkg = 'pyautogui'\ntry:\n    importlib.import_module(pkg)\nexcept ImportError:\n    subprocess.check_call([sys.executable, '-m', 'pip', 'install', pkg, '--quiet'])\nimport pyautogui\nraw_keys = input_data.get('keys')\nif raw_keys is None or (isinstance(raw_keys, str) and not raw_keys.strip()) or (isinstance(raw_keys, list) and not raw_keys):\n    output = json.dumps({'status': 'error', 'message': 'keys is required.'})\n    exit()\nkeys_seq = raw_keys if isinstance(raw_keys, list) else [raw_keys]\ntry:\n    for entry in keys_seq:\n        if not isinstance(entry, str) or not entry.strip():\n            raise ValueError('Invalid key string.')\n        combo = [k.strip() for k in entry.lower().split('+') if k.strip()]\n        if len(combo) == 0:\n            raise ValueError('Invalid key string.')\n        if len(combo) == 1:\n            pyautogui.press(combo[0])\n        else:\n            pyautogui.hotkey(*combo)\n    output = json.dumps({'status': 'success', 'message': ''})\nexcept Exception as e:\n    output = json.dumps({'status': 'error', 'message': str(e)})"
}
