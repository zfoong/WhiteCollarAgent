{
  "_id": {
    "$oid": "684046760dceb231ab654922"
  },
  "name": "create word file",
  "description": "This action creates a Word (.docx) file at the specified file path using the provided Markdown content. It converts Markdown to a Word document using python-docx, supporting headings (levels 1-6), paragraphs, bold, italics, bullet lists, and numbered lists. If the content is empty or invalid, the action will return an appropriate error. This action is production-ready and handles file permission errors gracefully.",
  "type": "atomic",
  "execution_mode": "sandboxed",
  "mode": "CLI",
  "code": "import json\nimport sys\nimport subprocess\nimport importlib\nimport os\nimport re\n\ndef _ensure(pkg: str) -> None:\n    try:\n        importlib.import_module(pkg)\n    except ImportError:\n        subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", pkg, \"--quiet\"])\n\n# Ensure required packages are installed\n[_ensure(_pkg) for _pkg in (\"python-docx\", \"markdown2\", \"beautifulsoup4\")]\n\nfrom docx import Document\nfrom docx.shared import Pt\nfrom bs4 import BeautifulSoup\nimport markdown2\n\ndef _add_paragraph_with_formatting(doc, element):\n    text = \"\"\n    runs = []\n\n    for item in element.descendants:\n        if isinstance(item, str):\n            text += item\n        elif item.name in (\"strong\", \"b\"):\n            runs.append((\"bold\", item.get_text()))\n        elif item.name in (\"em\", \"i\"):\n            runs.append((\"italic\", item.get_text()))\n\n    if not runs:\n        doc.add_paragraph(text.strip())\n    else:\n        p = doc.add_paragraph()\n        cursor = 0\n        for fmt, run_text in runs:\n            before = text.find(run_text, cursor)\n            if before > cursor:\n                p.add_run(text[cursor:before])\n            run = p.add_run(run_text)\n            if fmt == \"bold\":\n                run.bold = True\n            elif fmt == \"italic\":\n                run.italic = True\n            cursor = before + len(run_text)\n        if cursor < len(text):\n            p.add_run(text[cursor:])\n\ndef _execute_action() -> None:\n    input_data = globals().get(\"input_data\", {})\n    file_path = str(input_data.get(\"file_path\", \"\")).strip()\n    content = str(input_data.get(\"content\", \"\")).strip()\n\n    if not file_path:\n        output = json.dumps({\n            \"status\": \"error\",\n            \"path\": \"\",\n            \"message\": \"The 'file_path' field is required.\"\n        }, ensure_ascii=False)\n        return\n\n    if not content:\n        output = json.dumps({\n            \"status\": \"error\",\n            \"path\": \"\",\n            \"message\": \"The 'content' field is required.\"\n        }, ensure_ascii=False)\n        return\n\n    try:\n        html_content = markdown2.markdown(content)\n        soup = BeautifulSoup(html_content, \"html.parser\")\n        doc = Document()\n\n        for element in soup.descendants:\n            if element.name:\n                tag = element.name.lower()\n                if tag.startswith(\"h\") and tag[1:].isdigit():\n                    level = int(tag[1])\n                    heading_text = element.get_text(strip=True)\n                    doc.add_heading(heading_text, level=level)\n                elif tag == \"p\":\n                    _add_paragraph_with_formatting(doc, element)\n                elif tag == \"ul\":\n                    for li in element.find_all(\"li\"):\n                        doc.add_paragraph(li.get_text(strip=True), style=\"List Bullet\")\n                elif tag == \"ol\":\n                    for li in element.find_all(\"li\"):\n                        doc.add_paragraph(li.get_text(strip=True), style=\"List Number\")\n\n        doc.save(file_path)\n        output = json.dumps({\n            \"status\": \"success\",\n            \"path\": file_path\n        }, ensure_ascii=False)\n    except Exception as e:\n        output = json.dumps({\n            \"status\": \"error\",\n            \"path\": \"\",\n            \"message\": str(e)\n        }, ensure_ascii=False)\n\n_execute_action()\n",
  "input_schema": {
    "file_path": {
      "type": "string",
      "example": "/home/user/documents/my_file.docx",
      "description": "The full path where the new Word file will be created. Make sure the directory exists and is writable by the agent."
    },
    "content": {
      "type": "string",
      "example": "# Heading 1\\n\\nThis is **bold** text.\\n\\n- Item 1\\n- Item 2\\n\\n1. First\\n2. Second",
      "description": "The Markdown-formatted content to be converted into a Word document. Supports headings (#, ##, etc.), paragraphs, bullet lists (-, *), numbered lists (1., 2.), bold (**text**), and italics (*text*)."
    }
  },
  "output_schema": {
    "status": {
      "type": "string",
      "example": "success",
      "description": "'success' if the file was created, 'error' otherwise."
    },
    "path": {
      "type": "string",
      "example": "/home/user/documents/my_file.docx",
      "description": "The path to the newly created Word document."
    },
    "message": {
      "type": "string",
      "example": "Permission denied.",
      "description": "Error message, present only if status is 'error'."
    }
  },
  "subActions": [],
  "default": false,
  "scope": [
    "global"
  ]
}
