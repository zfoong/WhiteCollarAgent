{
  "_id": {
    "$oid": "688dddea12c6041305c2b1e2"
  },
  "name": "window focus",
  "description": "Brings an existing application window to the foreground (switches focus) by matching its title.",
  "type": "atomic",
  "execution_mode": "sandboxed",
  "mode": "GUI",
  "input_schema": {
    "title": {
      "type": "string",
      "example": "Notepad",
      "description": "Substring (case-insensitive) of the window title to match (required)."
    },
    "exact": {
      "type": "boolean",
      "example": false,
      "description": "If true, match the title exactly; otherwise use substring matching (default: false)."
    },
    "index": {
      "type": "integer",
      "example": 0,
      "description": "If multiple windows match, select by zero-based index (default: 0)."
    }
  },
  "output_schema": {
    "status": {
      "type": "string",
      "example": "success",
      "description": "'success' if focus changed, 'error' otherwise."
    },
    "matched_title": {
      "type": "string",
      "example": "Untitled - Notepad",
      "description": "The exact title of the window that was focused (present on success)."
    },
    "message": {
      "type": "string",
      "example": "No matching window found.",
      "description": "Optional error message."
    }
  },
  "subActions": [],
  "default": false,
  "scope": [
    "global"
  ],
  "code": "import json, sys, subprocess, importlib\npkg = 'pygetwindow'\ntry:\n    importlib.import_module(pkg)\nexcept ImportError:\n    subprocess.check_call([sys.executable, '-m', 'pip', 'install', pkg, '--quiet'])\n\nimport pygetwindow as gw\n\ntitle = str(input_data.get('title', '')).strip()\nexact = bool(input_data.get('exact', False))\nindex = int(input_data.get('index', 0))\n\nif not title:\n    output = json.dumps({'status': 'error', 'matched_title': '', 'message': 'title is required.'})\n    sys.exit()\n\ntry:\n    windows = gw.getWindowsWithTitle(title) if not exact else [w for w in gw.getAllWindows() if w.title == title]\n    if not windows:\n        output = json.dumps({'status': 'error', 'matched_title': '', 'message': 'No matching window found.'})\n        sys.exit()\n    if index < 0 or index >= len(windows):\n        output = json.dumps({'status': 'error', 'matched_title': '', 'message': 'index out of range.'})\n        sys.exit()\n    win = windows[index]\n    win.activate()\n    output = json.dumps({'status': 'success', 'matched_title': win.title, 'message': ''})\nexcept Exception as e:\n    output = json.dumps({'status': 'error', 'matched_title': '', 'message': str(e)})"
}
