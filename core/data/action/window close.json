{
  "_id": {
    "$oid": "688de1e812c6041305c2b1e8"
  },
  "name": "window close",
  "description": "Closes an application window. If a title is provided, the first matching window is closed; otherwise the currently active window is closed.",
  "type": "atomic",
  "execution_mode": "sandboxed",
  "mode": "GUI",
  "input_schema": {
    "title": {
      "type": "string",
      "example": "Microsoft Word",
      "description": "Substring (case-insensitive) of the window title to match. If omitted, the active window is used."
    },
    "exact": {
      "type": "boolean",
      "example": false,
      "description": "If true, match the title exactly; otherwise use substring matching (default: false)."
    },
    "index": {
      "type": "integer",
      "example": 0,
      "description": "If multiple windows match, select by zero-based index (default: 0)."
    }
  },
  "output_schema": {
    "status": {
      "type": "string",
      "example": "success",
      "description": "'success' if the window was closed, 'error' otherwise."
    },
    "matched_title": {
      "type": "string",
      "example": "Document1 â€“ Word",
      "description": "Title of the window that was closed (present on success)."
    },
    "message": {
      "type": "string",
      "example": "No matching window found.",
      "description": "Optional error message."
    }
  },
  "subActions": [],
  "default": false,
  "scope": [
    "global"
  ],
  "code": "import json, sys, subprocess, importlib\npkg = 'pygetwindow'\ntry:\n    importlib.import_module(pkg)\nexcept ImportError:\n    subprocess.check_call([sys.executable, '-m', 'pip', 'install', pkg, '--quiet'])\n\nimport pygetwindow as gw\n\ntitle = str(input_data.get('title', '')).strip()\nexact = bool(input_data.get('exact', False))\nindex = int(input_data.get('index', 0))\n\ntry:\n    if title:\n        windows = gw.getWindowsWithTitle(title) if not exact else [w for w in gw.getAllWindows() if w.title == title]\n        if not windows:\n            output = json.dumps({'status': 'error', 'matched_title': '', 'message': 'No matching window found.'})\n            sys.exit()\n        if index < 0 or index >= len(windows):\n            output = json.dumps({'status': 'error', 'matched_title': '', 'message': 'index out of range.'})\n            sys.exit()\n        win = windows[index]\n    else:\n        win = gw.getActiveWindow()\n        if win is None:\n            output = json.dumps({'status': 'error', 'matched_title': '', 'message': 'No active window to close.'})\n            sys.exit()\n    win.close()\n    output = json.dumps({'status': 'success', 'matched_title': win.title, 'message': ''})\nexcept Exception as e:\n    output = json.dumps({'status': 'error', 'matched_title': '', 'message': str(e)})"
}
