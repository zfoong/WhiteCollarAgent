name: Check weather condition online
description: Retrieve up-to-date weather for a specified location with a simple google search.

goal/outcome:
  - Confirmed location and units (metric/imperial) for the query.
  - Successful information returning temperature, conditions, and location metadata.
  - Concise user-facing summary that includes location, temperature with units, time range, and condition description.
  - Advice user on their activity corresponding to the weather if they provide any.

inputs_params:
  - Required: Location (city name or city + region/country for disambiguation).
  - Optional: Units preference (metric/imperial) and time range.

context:
  reasoning:
    - Confirm the target location; if unclear, ask the user for a quick clarification.
    - Use the "google search" action to get weather information online.
    - Validate the response status and handle obvious errors (invalid location, missing key) with a brief follow-up to the user.
    - Use 'google search' action with query 'The weather in {location} for {time}' instead. 
  deadline: ASAP
  definition_of_done(check during final validation step):
    - Weather data returned successfully for the requested location with status OK.
    - Summary message includes location, temperature (with units if available), and a brief condition description.
  avoid:
    - Running complex multi-step workflows; keep this to a single quick fetch and report.
    - This is just a simple task. You MUST avoid taking too many action steps.

steps:
  name: Confirm location
  description: Ensure the target location (and units if relevant) are understood if not provided by the user.
  action_instruction: If the request lacks a clear location or units, ask the user once for the needed detail; otherwise proceed with provided information.

  name: Fetch weather information via web search
  description: Use a single web search to obtain current weather information for the location, with an optional fallback to reading a single page.
  action_instruction: >
    Use "google search" with:
      - query = "current weather in {location}"
      - num_results = a small number like 3
    Inspect the returned "search_results":
      - Look for entries whose title or snippet clearly indicate weather information (e.g., includes "Weather", temperature, °C or °F).
      - From the best-looking result:
        - Extract location label if present.
        - Extract temperature and units if present in snippet.
        - Extract a phrase describing current conditions if present (e.g., "Partly cloudy", "Rain showers").
    If the snippet does NOT contain enough information (no temperature or condition):
      - Optionally call "read web page from URL" on the best candidate URL (e.g., a known weather site link from the search results).
      - From the returned "content", extract:
        - A temperature reading.
        - A short condition phrase.
    Keep this parsing lightweight: rely mostly on the visible text in titles/snippets/first lines, not heavy text processing.
  validation_instruction: >
    Make sure you have at least:
    - Some indication of current condition (e.g., clear, cloudy, rain).
    - Either an explicit temperature with units, or clearly state if temperature could not be reliably read.
    If all search attempts fail (no relevant results, or page not readable), prepare to tell the user clearly that the weather
    could not be retrieved for {location}.

  name: Deliver summary
  description: Share the results concisely with the user with human readable format.
  action_instruction: Use "send_message" (or include in a larger task’s messaging) to report the location, temperature with units, and condition summary. Remove temporary scripts unless the user requests to keep them.